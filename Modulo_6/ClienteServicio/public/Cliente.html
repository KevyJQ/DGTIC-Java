<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<title>Cliente de un servicio REST</title>
</head>
<body>
	<div ng-app="serviciores" ng-controller="enlace" class="container"
		ng-init="cargar()">
		<h1>Estudiantes</h1>
		<br />
		<div>
			<table border="1" class="table table-striped table-bordered">
				<thead>
					<tr>
						<th>Cuenta</th>
						<th>Nombre</th>
						<th>Edad</th>
						<th>Materias</th>
						<th>Eliminar</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="r in contactos">
						<td>{{r.cuenta}}</td>
						<td>{{r.nombre}}</td>
						<td>{{r.edad}}</td>
						<td>
							<table border="1" class="table table-striped table-bordered">
								<tr>
									<th>id</th>
									<th>nombre</th>
									<th>creditos</th>
								</tr>
								<tbody>
									<tr ng-repeat="m in r.materias">
										<td>{{m.id}}</td>
										<td>{{m.nombre}}</td>
										<td>{{m.creditos}}</td>
									</tr>
								</tbody>
							</table>
						</td>
						<td><a href="#" ng-click="eliminar(r.cuenta)">Eliminar</a></td>
					</tr>
				</tbody>
			</table>
		</div>
		<br />
	</div>
	<script>
		var ap = angular.module("serviciores", []);
		ap.controller("enlace", function($scope, $http) {
			$scope.contactos = [];
			$scope.cargar = function() {
				let url = "http://localhost:8080/estudiantes";
				$http.get(url).then(function(res) {
					$scope.contactos = res.data;
				});
			}
			$scope.eliminar = function(id) {
				let url = "http://localhost:8080/borrar";
				$http({
					method : "DELETE",
					url : url + "/" + id
				}).then(function(res) {
					$scope.cargar();
				});
			}
		});
	</script>
</body>
</html>
